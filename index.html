<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Baggage Claim System - Display</title>
    <style>
        body { margin: 0; background-color: #121212; color: white; font-family: 'Noto Sans KR', sans-serif; overflow: hidden; }
        
        #display-board {
            width: 100vw; height: 100vh;
            display: flex; flex-direction: column;
            border: 10px solid #222; box-sizing: border-box;
        }

        .header {
            background-color: black; height: 15%;
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 40px; border-bottom: 2px solid #333;
        }
        .header-left { display: flex; align-items: center; gap: 20px; }
        .belt-tag { font-size: 100px; color: #FFD700; font-weight: 900; }

        .main-info {
            background: linear-gradient(to bottom, #4a628a, #2e3e5e);
            height: 55%; display: flex; padding: 40px; justify-content: space-between;
        }
        .status-box { display: flex; flex-direction: column; justify-content: center; width: 50%; }
        #status-text { font-size: 75px; font-weight: bold; margin-bottom: 10px; transition: opacity 0.5s; min-height: 110px; }
        .flight-details { font-size: 45px; display: flex; align-items: center; gap: 25px; }
        .airline-logo { background: white; color: #003399; padding: 5px 15px; font-weight: bold; border-radius: 4px; }

        .cctv-container {
            width: 45%; height: 100%; background: black; border: 4px solid #555;
            position: relative; overflow: hidden;
        }

        .next-flights {
            background: black; height: 20%; padding: 10px 40px;
            font-size: 30px; display: flex; flex-direction: column; justify-content: center;
        }
        .flight-row { display: flex; justify-content: space-between; border-bottom: 1px solid #333; padding: 8px 0; }

        .ticker {
            background: white; color: black; height: 10%;
            display: flex; align-items: center; font-size: 28px; font-weight: bold;
            overflow: hidden; position: relative;
        }
        .ticker-text {
            position: absolute; white-space: nowrap;
            animation: marquee 20s linear infinite;
        }
        @keyframes marquee {
            0% { left: 100%; }
            100% { left: -100%; }
        }
    </style>
</head>
<body>

<div id="display-board">
    <div class="header">
        <div class="header-left">
            <img src="https://cdn-icons-png.flaticon.com/512/263/263058.png" width="60" style="filter: invert(1);">
            <div style="font-size: 35px; line-height: 1.2;">수하물 찾는 곳<br><span style="font-size: 25px;">Baggage Claim</span></div>
        </div>
        <div class="belt-tag" id="belt-num">1</div>
    </div>

    <div class="main-info">
        <div class="status-box">
            <div id="status-text">연결 대기중...</div>
            <div class="flight-details">
                <span id="origin-city">---</span>
                <span class="airline-logo">KOREAN AIR</span>
                <span id="flight-num">---</span>
            </div>
        </div>
        <div class="cctv-container">
            <iframe id="cctv-frame" width="100%" height="100%" 
                    src="" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
    </div>

    <div class="next-flights">
        <div class="flight-row">
            <span>BUSAN</span> <span>KE 1118</span> <span style="color: #aaa;">Landed</span>
        </div>
        <div class="flight-row">
            <span>JEJU</span> <span>KE 1258</span> <span></span>
        </div>
    </div>

    <div class="ticker">
        <div class="ticker-text" id="announcement">데이터를 불러오는 중입니다...</div>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    // [중요] 본인의 Firebase 설정값을 여기에 복사해서 넣으세요
const firebaseConfig = {
  apiKey: "AIzaSyAyuJDE755VS_kebUr7U9LAP34XVEM4qpM",
  authDomain: "baggage-claim-system.firebaseapp.com",
  databaseURL: "https://baggage-claim-system-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "baggage-claim-system",
  storageBucket: "baggage-claim-system.firebasestorage.app",
  messagingSenderId: "512539951611",
  appId: "1:512539951611:web:5a36dbdaf27c2618334b5e"
};

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const dbRef = ref(db, 'baggage_system');

    let statusKO = "연결중";
    let statusEN = "Connecting";
    let currentLang = 'ko';

    // 실시간 데이터 수신
    onValue(dbRef, (snapshot) => {
        const data = snapshot.val();
        if (data) {
            document.getElementById('flight-num').innerText = data.flight_no || "---";
            document.getElementById('origin-city').innerText = data.origin || "---";
            document.getElementById('belt-num').innerText = data.belt_no || "1";
            document.getElementById('announcement').innerText = data.marquee || "";
            
            if (data.youtube_id) {
                document.getElementById('cctv-frame').src = `https://www.youtube.com/embed/${data.youtube_id}?autoplay=1&mute=1`;
            }

            statusKO = data.status_ko || "준비중";
            statusEN = data.status_en || "Ready";
            document.getElementById('status-text').innerText = (currentLang === 'ko') ? statusKO : statusEN;
        }
    });

    // 5초마다 한/영 전환
    setInterval(() => {
        const el = document.getElementById('status-text');
        el.style.opacity = 0;
        setTimeout(() => {
            currentLang = (currentLang === 'ko') ? 'en' : 'ko';
            el.innerText = (currentLang === 'ko') ? statusKO : statusEN;
            el.style.opacity = 1;
        }, 500);
    }, 5000);
</script>
</body>
</html>
